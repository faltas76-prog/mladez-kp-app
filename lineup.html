<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Match Lineup PRO</title>

<style>
body {
  margin:0;
  font-family:Arial, sans-serif;
  background:#111;
  color:white;
}

header {
  text-align:center;
  padding:15px;
  font-size:22px;
}

.controls {
  padding:15px;
  position:relative;
  z-index:100;
  background:#111;
}
button {
  width:100%;
  padding:12px;
  margin:6px 0;
  font-size:14px;
  background:#00fff7;
  border:none;
  cursor:pointer;
}
select, button {
  width:100%;
  padding:10px;
  margin:6px 0;
}

/* ===== Z√ÅKLAD H≈òI≈†Tƒö ===== */
#pitch {
  position: relative;
  width: 100%;
  max-width: 900px;
  aspect-ratio: 2 / 3;
  margin: auto;
  border: 4px solid white;
  overflow: hidden;

  background:
    repeating-linear-gradient(
      to bottom,
      #1b5e20 0%,
      #1b5e20 8%,
      #2e7d32 8%,
      #2e7d32 16%
    );
}

/* ===== OBECN√â ƒå√ÅRY ===== */
.pitch-line {
  position: absolute;
  border: 2px solid white;
  pointer-events: none;
}

/* ===== ST≈òED ===== */
.center-line {
  position: absolute;
  width: 100%;
  height: 2px;
  background: white;
  top: 50%;
}

.center-circle {
  position: absolute;
  width: 18%;
  aspect-ratio: 1;
  border: 2px solid white;
  border-radius: 50%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* ===== VELK√â V√ÅPNO ===== */
.penalty-area {
  position: absolute;
  width: 62%;
  height: 22%;
  left: 19%;
  border: 2px solid white;
}

.penalty-area.top {
  top: 0;
  border-bottom: none;
}

.penalty-area.bottom {
  bottom: 0;
  border-top: none;
}

/* ===== MAL√â V√ÅPNO ===== */
.goal-area {
  position: absolute;
  width: 32%;
  height: 10%;
  left: 34%;
  border: 2px solid white;
}

.goal-area.top {
  top: 0;
  border-bottom: none;
}

.goal-area.bottom {
  bottom: 0;
  border-top: none;
}

/* ===== PENALTOV√ù BOD ===== */
.penalty-spot {
  position: absolute;
  width: 6px;
  height: 6px;
  background: white;
  border-radius: 50%;
  left: 50%;
  transform: translateX(-50%);
}

.penalty-spot.top {
  top: 18%;
}

.penalty-spot.bottom {
  bottom: 18%;
}

/* ===== PENALTOV√ù OBLOUK ===== */
.penalty-arc {
  position: absolute;
  width: 20%;
  aspect-ratio: 1;
  border: 2px solid white;
  border-radius: 50%;
  left: 50%;
  transform: translateX(-50%);
}

.penalty-arc.top {
  top: 14%;
  clip-path: inset(50% 0 0 0);
}

.penalty-arc.bottom {
  bottom: 14%;
  clip-path: inset(0 0 50% 0);
}

/* ===== BRANKA ===== */
.goal {
  position: absolute;
  width: 22%;
  height: 2%;
  left: 39%;
  background: white;
}

.goal.top {
  top: 0;
}

.goal.bottom {
  bottom: 0;
}

/* ===== ROHY ===== */
.corner {
  position: absolute;
  width: 6%;
  aspect-ratio: 1;
  border: 2px solid white;
  border-radius: 50%;
}

.corner.tl { top: -3%; left: -3%; clip-path: inset(0 0 50% 50%); }
.corner.tr { top: -3%; right: -3%; clip-path: inset(0 50% 50% 0); }
.corner.bl { bottom: -3%; left: -3%; clip-path: inset(50% 0 0 50%); }
.corner.br { bottom: -3%; right: -3%; clip-path: inset(50% 50% 0 0); }


/* Hr√°ƒçi ‚Äì velikost se p≈ôizp≈Øsobuje */
.player {
  position: absolute;
  width: 7%;
  aspect-ratio: 1;
  border-radius: 50%;
  background: #00fff7;
  display: flex;
  align-items: center;
  justify-content: center;
  transform: translate(-50%, -50%);
  z-index: 10;
  overflow: visible;
}

/* ≈°t√≠tek pod hr√°ƒçem */
.player-position {
  position: absolute;
  top: -30%;
  left: 50%;
  transform: translateX(-50%);
  font-size: clamp(8px, 1vw, 12px);
  color: white;
  pointer-events: none;
}

.player-label {
  position: absolute;
  top: 115%;
  left: 50%;
  transform: translateX(-50%);
  font-size: clamp(8px, 1vw, 12px);
  color: white;
  white-space: nowrap;
  pointer-events: none;
}

.player-number {
  font-size: clamp(14px, 1.6vw, 20px);
  font-weight: bold;
  color: black;
  pointer-events: none;
}

.captain::after {
  content: " C";
  color: red;
  font-weight: bold;
}

#bench {
  background:#222;
  padding:10px;
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}

.bench-player {
  width:60px;
  height:60px;
  border-radius:50%;
  background:#ff9800;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:11px;
  cursor:pointer;
}

/* MODAL */
#editModal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.8);
  display:none;
  align-items:center;
  justify-content:center;
}

#modalContent {
  background:#222;
  padding:20px;
  width:300px;
}
</style>
</head>

<body>

<header>‚öΩ MATCH LINEUP PRO</header>

<div class="controls">
  <select id="formationSelect">
    <option value="1-4-4-2">1-4-4-2</option>
    <option value="1-4-2-3-1">1-4-2-3-1</option>
    <option value="1-4-3-3">1-4-3-3</option>
  </select>

  <button id="createBtn">Vytvo≈ôit rozestaven√≠</button>
  <button id="exportBtn">üì§ Export PNG</button>
  <button id="exportPdfBtn">üìÑ Export PDF</button>
  <button id="saveBtn">üíæ Ulo≈æit sestavu</button>
</div>


<div id="pitch">

  <div class="center-line"></div>
  <div class="center-circle"></div>

  <div class="penalty-area top"></div>
  <div class="goal-area top"></div>
  <div class="penalty-spot top"></div>
  <div class="penalty-arc top"></div>
  <div class="goal top"></div>

  <div class="penalty-area bottom"></div>
  <div class="goal-area bottom"></div>
  <div class="penalty-spot bottom"></div>
  <div class="penalty-arc bottom"></div>
  <div class="goal bottom"></div>

  <div class="corner tl"></div>
  <div class="corner tr"></div>
  <div class="corner bl"></div>
  <div class="corner br"></div>

</div>



  <!-- DOLN√ç POLOVINA -->
  <div class="penalty-area bottom"></div>
  <div class="goal-area bottom"></div>
  <div class="penalty-spot bottom"></div>
  <div class="goal bottom"></div>

  <!-- HORN√ç POLOVINA -->
  <div class="penalty-area top"></div>
  <div class="goal-area top"></div>
  <div class="penalty-spot top"></div>
  <div class="goal top"></div>

</div>
<div class="penalty-arc top"></div>
<div class="penalty-arc bottom"></div>

<h3 style="padding:10px">ü™ë Laviƒçka n√°hradn√≠k≈Ø</h3>
<div id="bench"></div>

<!-- MODAL -->
<div id="editModal">
  <div id="modalContent">
    <h3>Upravit hr√°ƒçe</h3>
    <input id="playerNameInput" placeholder="Jm√©no hr√°ƒçe">
    <button id="confirmNameBtn">OK</button>
  </div>
</div>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {

  const pitch = document.getElementById("pitch");
  const saveBtn = document.getElementById("saveBtn");
  const exportBtn = document.getElementById("exportBtn");
  const exportPdfBtn = document.getElementById("exportPdfBtn");

  /* ===== ULO≈ΩEN√ç ===== */
  saveBtn.addEventListener("click", function() {
    const data = [];
    document.querySelectorAll(".player").forEach(p => {
      data.push({
        name: p.textContent,
        x: p.style.left,
        y: p.style.top
      });
    });

    localStorage.setItem("MATCH_LINEUP", JSON.stringify(data));
    alert("Sestava ulo≈æena ‚úî");
  });

  /* ===== EXPORT PNG ===== */
  exportBtn.addEventListener("click", function() {
    html2canvas(pitch).then(canvas => {
      const link = document.createElement("a");
      link.download = "rozestaveni.png";
      link.href = canvas.toDataURL();
      link.click();
    });
  });

  /* ===== EXPORT PDF ===== */
  exportPdfBtn.addEventListener("click", async function() {
    const { jsPDF } = window.jspdf;
    const canvas = await html2canvas(pitch);
    const imgData = canvas.toDataURL("image/png");

    const pdf = new jsPDF();
    pdf.addImage(imgData, "PNG", 10, 10, 180, 250);
    pdf.save("rozestaveni.pdf");
  });

});
</script>

<script>
const pitch = document.getElementById("pitch");
const createBtn = document.getElementById("createBtn");
const formationSelect = document.getElementById("formationSelect");
const bench = document.getElementById("bench");
const editModal = document.getElementById("editModal");
const playerNameInput = document.getElementById("playerNameInput");
const confirmNameBtn = document.getElementById("confirmNameBtn");

let selectedPlayer = null;

/* VYTVO≈ò ROZESTAVEN√ç */
createBtn.onclick = () => {
  pitch.querySelectorAll(".player").forEach(p => p.remove());
  bench.innerHTML = "";

  const rows = formationSelect.value.split("-").map(Number);
  const h = pitch.clientHeight;
  const w = pitch.clientWidth;

  rows.forEach((count, rowIndex) => {
    for (let i = 0; i < count; i++) {

      const player = createPlayer(rowIndex === 0 && count === 1 ? "GK" : "Hr√°ƒç");

      const yPercent = 100 - ((rowIndex + 1) * (100 / (rows.length + 1)));
const xPercent = ((i + 1) * (100 / (count + 1)));

player.style.left = xPercent + "%";
player.style.top = yPercent + "%";
player.style.transform = "translate(-50%, -50%)";


      pitch.appendChild(player);
    }
  });

  // vytvo≈ô 5 n√°hradn√≠k≈Ø
  for (let i = 1; i <= 5; i++) {
    const benchPlayer = document.createElement("div");
    benchPlayer.className = "bench-player";
    benchPlayer.textContent = "N" + i;

    benchPlayer.onclick = () => {
      const newPlayer = createPlayer("N" + i);
      newPlayer.style.left = "50%";
      newPlayer.style.top = "50%";
      pitch.appendChild(newPlayer);
    };

    bench.appendChild(benchPlayer);
  }
};

/* VYTVO≈ò HR√ÅƒåE */
function createPlayer(number, isGK = false) {

  const player = document.createElement("div");
  player.className = "player";

  // ƒç√≠slo hr√°ƒçe
  player.textContent = isGK ? "GK" : number;

  if (isGK) {
    player.style.background = "#ffcc00";
  }

  // ≈°t√≠tek se jm√©nem
  const label = document.createElement("div");
  label.className = "player-label";
  label.textContent = "Hr√°ƒç";

  player.appendChild(label);

  makeDraggable(player);

  player.onclick = (e) => {
    e.stopPropagation();
    selectedPlayer = label;
    playerNameInput.value = label.textContent;
    editModal.style.display = "flex";
  };

  return player;
}


/* DRAG */
function makeDraggable(el) {
  el.addEventListener("pointerdown", e => {
    el.setPointerCapture(e.pointerId);
  });

  el.addEventListener("pointermove", e => {
    if (e.buttons !== 1) return;

    const rect = pitch.getBoundingClientRect();

    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;

    el.style.left = x + "%";
    el.style.top = y + "%";
    el.style.transform = "translate(-50%, -50%)";
  });
}


/* POTVRZEN√ç JM√âNA */
confirmNameBtn.onclick = () => {
  if (selectedPlayer) {
    selectedPlayer.textContent = playerNameInput.value;
  }
  editModal.style.display = "none";
};
</script>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="js/lineup.js"></script>

</body>
</html>
