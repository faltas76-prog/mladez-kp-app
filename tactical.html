<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Tactical Pad ‚Äì STABLE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #1e1e1e;
  color: #fff;
  font-family: Arial, sans-serif;
}

.toolbar {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  padding: 8px;
  background: #333;
}

button, select {
  padding: 6px 10px;
  font-size: 14px;
}

#wrap {
  width: 100%;
  height: calc(100vh - 56px);
}

canvas {
  width: 100%;
  height: 100%;
  background: #2e7d32;
  display: block;
  touch-action: none;
}
</style>
</head>

<body>

<div class="toolbar">
  <button id="drawBtn">‚úèÔ∏è Kreslit</button>
  <button id="eraseBtn">üßΩ Mazat</button>

  <button id="ballBtn">‚öΩ</button>
  <button id="coneBtn">üî∫</button>
  <button id="hurdleBtn">üü¶</button>
  <button id="goalBtn">ü•Ö</button>

  <select id="sizeSelect">
    <option value="15">S</option>
    <option value="25" selected>M</option>
    <option value="40">L</option>
  </select>

  <button id="resetBtn">‚ôªÔ∏è Reset</button>
</div>

<div id="wrap">
  <canvas id="canvas"></canvas>
</div>

<script>
console.log("TACTICAL PAD INLINE JS RUNNING");

/* ===== Z√ÅKLAD ===== */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

/* ===== RESIZE ‚Äì TV√Å FUNKƒåN√ç VERZE ===== */
function resizeCanvas() {
  const rect = canvas.getBoundingClientRect();
  canvas.width = rect.width;
  canvas.height = rect.height;
  redraw();
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

/* ===== STAV ===== */
let mode = "draw";
let tool = null;
let drawing = false;
let currentLine = null;

let lines = [];
let objects = [];

/* ===== TLAƒå√çTKA ‚Äì 100% JISTOTA ===== */
drawBtn.onclick = () => { mode = "draw"; tool = null; };
eraseBtn.onclick = () => { mode = "erase"; tool = null; };

ballBtn.onclick = () => { mode = "object"; tool = "ball"; };
coneBtn.onclick = () => { mode = "object"; tool = "cone"; };
hurdleBtn.onclick = () => { mode = "object"; tool = "hurdle"; };
goalBtn.onclick = () => { mode = "object"; tool = "goal"; };

resetBtn.onclick = () => {
  if (!confirm("Vymazat cel√© cviƒçen√≠?")) return;
  lines = [];
  objects = [];
  redraw();
};

/* ===== POZICE ===== */
function pos(e) {
  const r = canvas.getBoundingClientRect();
  return {
    x: e.clientX - r.left,
    y: e.clientY - r.top
  };
}

/* ===== INTERAKCE ===== */
canvas.addEventListener("pointerdown", e => {
  const p = pos(e);
  drawing = true;

  if (mode === "draw") {
    currentLine = [p];
    lines.push(currentLine);
  }

  if (mode === "object" && tool) {
    objects.push({
      type: tool,
      x: p.x,
      y: p.y,
      size: parseInt(sizeSelect.value)
    });
    redraw();
  }

  if (mode === "erase") {
    lines = lines.filter(l =>
      !l.some(pt => Math.hypot(pt.x - p.x, pt.y - p.y) < 10)
    );
    objects = objects.filter(o =>
      Math.hypot(o.x - p.x, o.y - p.y) > o.size
    );
    redraw();
  }
});

canvas.addEventListener("pointermove", e => {
  if (!drawing || mode !== "draw") return;
  currentLine.push(pos(e));
  redraw();
});

canvas.addEventListener("pointerup", () => {
  drawing = false;
  currentLine = null;
});

/* ===== VYKRESLEN√ç ===== */
function redraw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.strokeStyle = "#ffeb3b";
  ctx.lineWidth = 3;
  ctx.lineCap = "round";

  lines.forEach(l => {
    ctx.beginPath();
    ctx.moveTo(l[0].x, l[0].y);
    l.forEach(p => ctx.lineTo(p.x, p.y));
    ctx.stroke();
  });

  objects.forEach(o => {
    if (o.type === "ball") {
      ctx.fillStyle = "#fff";
      ctx.beginPath();
      ctx.arc(o.x, o.y, o.size / 2, 0, Math.PI * 2);
      ctx.fill();
    }
    if (o.type === "cone") {
      ctx.fillStyle = "#ff9800";
      ctx.beginPath();
      ctx.moveTo(o.x, o.y - o.size);
      ctx.lineTo(o.x - o.size, o.y + o.size);
      ctx.lineTo(o.x + o.size, o.y + o.size);
      ctx.fill();
    }
    if (o.type === "hurdle") {
      ctx.fillStyle = "#2196f3";
      ctx.fillRect(o.x - o.size, o.y - o.size / 4, o.size * 2, o.size / 2);
    }
    if (o.type === "goal") {
      ctx.strokeStyle = "#fff";
      ctx.lineWidth = 3;
      ctx.strokeRect(
        o.x - o.size * 1.5,
        o.y - o.size / 2,
        o.size * 3,
        o.size
      );
    }
  });
}
</script>

</body>
</html>
